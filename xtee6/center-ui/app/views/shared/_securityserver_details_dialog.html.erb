<%= dialog "securityserver_details_dialog", t("securityservers.details.title") do %>
  <div id="securityserver_details">
    <fieldset id="securityserver_details_fieldset">
      <legend>
        <%= t 'securityservers.details.legend' %>
        <% if can?(:delete_security_server) %>
          <button id="securityserver_delete">
            <%= t 'securityserver.delete' %>
          </button>
        <% end %>
      </legend>
      <%= form_tag do %>
      <table id="securityserver_details_table">
        <tr>
          <td/>
        </tr>
          <td><%= t 'securityservers.owner_name' %></td>
          <td><input id="securityserver_details_owner_name" type="text" readonly/></td>
        </tr>
        <tr>
          <td><%= t 'securityservers.owner_class' %></td>
          <td><input id="securityserver_details_owner_class" type="text" readonly/></td>
        </tr>
        <tr>
          <td><%= t 'securityservers.owner_code' %></td>
          <td><input id="securityserver_details_owner_code" type="text" readonly/></td>
        </tr>
        <tr>
          <td><%= t 'securityservers.securityserver_code' %></td>
          <td><input id="securityserver_details_server_code" type="text" readonly/></td>
        </tr>
        <tr>
          <td><%= t 'securityservers.registered' %></td>
          <td><input id="securityserver_details_registered" type="text" readonly/></td>
        </tr>
        <tr>
        <tr>
          <td><%= t 'securityservers.address' %></td>
          <td><input id="securityserver_details_address" type="text" readonly/></td>
          <td>
            <% if can?(:edit_security_server_address) %>
              <button id="securityserver_details_change_address">
                <%= t 'common.edit' %>
              </button>
            <% end %>
          </td>
        </tr>
      </table>
      <% end %>
      <p id="securityserver_details_identifier"></p>
    </fieldset>
  </div>

  <div class="clearer"></div>

  <div>
    <fieldset class="fill">
      <legend>
        <% if can?(:view_security_server_details) %>
          <button id="toggle_securityserver_security_categories" data-refresh="refreshSecurityServerCategories" class=toggle_table>+</button>
        <% end %>
        <%= t 'securityservers.categories.legend' %>
        <% if can?(:edit_security_server_security_category) %>
          <button id="security_categories_edit"><%= t 'common.edit' %></button>
        <% end %>
      </legend>
      <table id="securityserver_security_categories" class="display">
        <thead>
          <tr>
            <th><%= t 'common.description' %></th>
          </tr>
        </thead>
      </table>
    </fieldset>
  </div>

  <div class="clearer"></div>

  <fieldset class="fill">
    <legend>
      <% if can?(:view_security_server_details) %>
        <button id="toggle_securityserver_clients" data-refresh="refreshClients" class=toggle_table>+</button>
      <% end %>
      <%= t 'securityservers.clients.legend' %>
    </legend>
    <table id="securityserver_clients" class="display">
      <thead>
        <tr>
          <th><%= t 'securityservers.clients.name' %></th>
          <th><%= t 'securityservers.clients.class' %></th>
          <th><%= t 'securityservers.clients.code' %></th>
          <th><%= t 'securityservers.clients.subsystem_code' %></th>
        </tr>
      </thead>
    </table>
  </fieldset>

  <div class="clearer"></div>

  <fieldset class="fill">
    <legend>
      <% if can?(:view_security_server_details) %>
        <button id="toggle_securityserver_auth_certs" data-refresh="refreshAuthCerts" class="toggle_table">+</button>
      <% end %>
      <%= t 'securityservers.auth_cert.legend' %>
      <% if can?(:add_security_server_auth_cert_reg_request) %>
        <button id="securityserver_authcert_add"><%= t 'common.add' %></button>
      <% end %>
      <% if can?(:delete_security_server_auth_cert) %>
        <button id="securityserver_authcert_delete"><%= t 'common.delete' %></button>
      <% end %>
    </legend>
    <table id="securityserver_auth_certs" class="display">
      <thead>
        <tr>
          <th><%= t 'securityservers.auth_cert.csp' %></th>
          <th><%= t 'securityservers.auth_cert.serial_number' %></th>
          <th><%= t 'securityservers.auth_cert.subject' %></th>
          <th><%= t 'securityservers.auth_cert.expires' %></th>
        </tr>
      </thead>
    </table>
  </fieldset>

  <div class="clearer"></div>

  <fieldset class="fill">
    <legend>
      <% if can?(:view_security_server_details) %>
        <button id="toggle_securityserver_management_requests" data-refresh="refreshServerManagementRequests" class=toggle_table>+</button>
      <% end %>
      <%= t 'management_requests.legend' %>
    </legend>
    <table id="securityserver_management_requests" class="display">
      <thead>
        <tr>
          <th><%= t 'management_requests.process_id' %></th>
          <th><%= t 'management_requests.process_type' %></th>
          <th><%= t 'management_requests.created' %></th>
          <th><%= t 'management_requests.status' %></th>
        </tr>
      </thead>
    </table>
  </fieldset>

  <%= render :partial => "shared/securityserver_address_edit_dialog" %>
  <%= render :partial => "shared/security_categories_edit_dialog" %>
  <%= render :partial => "shared/auth_cert_add_dialog" %>
  <%= render :partial => "shared/auth_cert_delete_dialog" %>
  <%= render :partial => "shared/cert_details_dialog" %>


  <!-- XXX Prevents infinite rendering loop -->
  <% if from_main_menu %>
    <%= render :partial => "shared/member_edit_dialog",
        locals: {from_main_menu: false} %>
  <% end %>
<% end %>