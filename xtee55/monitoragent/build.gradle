plugins {
  id "eu.appsatori.fatjar" version "0.3"
}

dependencies {
    compile project(':mediator-common')

    // SDSB dependencies
    compile 'ee.cyber.sdsb:common-util:1.0'
}

fatJarPrepareFiles {
    include '*'
}

fatJar {
    exclude "META-INF/*.SF"
    exclude "META-INF/*.DSA"
    exclude "META-INF/*.RSA"

    manifest {
        attributes 'Main-Class': 'ee.cyber.xroad.monitoragent.Main'
    }
}

jar.enabled = false
build.dependsOn fatJar

task runMonitorAgent(type: JavaExec) {
    jvmArgs '-Dee.cyber.xroad.monitoragent.runProgram=echo',
        '-Dee.cyber.sdsb.appLog.path=log'

    main = 'ee.cyber.xroad.monitoragent.Main'
    classpath = sourceSets.main.runtimeClasspath
}

task runAgentTest(type: JavaExec) {
    main = 'ee.cyber.xroad.monitoragent.TestMonitorAgent'
    classpath = sourceSets.test.runtimeClasspath
    jvmArgs '-Dee.cyber.sdsb.monitoringagent.uri=akka.tcp://XroadMonitoringAgent@127.0.0.1:2552/user/DataReceiver',
        '-Dee.cyber.sdsb.appLog.path=log'
}
